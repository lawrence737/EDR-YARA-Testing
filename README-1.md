Read my series on Medium which dives into the data in this repository and provides more context, this README is for the first part of the series: 

Below are the results from my testing which you may use as a template in your own testing. Note that policy settings must also be set, you can view the recommendation for what policy settings to set, along with more detail on what we set in our testing, <a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Policy-Settings">here</a>. 

**Section 1: Malicious Binaries**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Empire Bash stager</td><td><a href="https://github.com/BC-SECURITY/Empire">empire</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Empire-C2-Tests">Empire C2 Tests</a></td></tr><tr><td>Empire Python stager</td><td><a href="https://github.com/BC-SECURITY/Empire">empire</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Empire-C2-Tests">Empire C2 Tests</a></td></tr><tr><td>Empire deobfuscated</td><td><a href="https://github.com/BC-SECURITY/Empire">empire</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Empire-C2-Tests">Empire C2 Tests</a></td></tr><tr><td>Apfell</td><td><a href="https://github.com/MythicAgents/apfell">apfell</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Apfell-Tests">Apfell Tests</a></td></tr><tr><td>Apfell with moved osascript</td><td><a href="https://github.com/MythicAgents/apfell">apfell</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Apfell-Tests">Apfell Tests</a></td></tr><tr><td>Apfell no comments</td><td><a href="https://github.com/MythicAgents/apfell">apfell</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Apfell-Tests">Apfell Tests</a></td></tr><tr><td>Poseidon</td><td><a href="https://github.com/MythicAgents/poseidon">Poseidon</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Poseidon-Tests">Poseidon Tests</a></td></tr><tr><td>Poseidon obfuscation</td><td><a href="https://github.com/MythicAgents/poseidon">Poseidon</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Poseidon-Tests">Poseidon Tests</a></td></tr><tr><td>Poseidon UPX</td><td><a href="https://github.com/MythicAgents/poseidon">Poseidon</a>,<a href="https://upx.github.io/"> UPX</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Poseidon-Tests">Poseidon Tests</a></td></tr><tr><td>Medusa</td><td><a href="https://github.com/MythicAgents/Medusa">medusa</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Medusa-Tests">Medusa Tests</a></td></tr><tr><td>Medusa obfuscation</td><td><a href="https://github.com/MythicAgents/Medusa">medusa</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Medusa-Tests">Medusa Tests</a></td></tr><tr><td>Sliver</td><td><a href="https://github.com/BishopFox/sliver">Sliver C2</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Sliver-Tests">Sliver Tests</a></td></tr></tbody></table>

**Section 2: Intermediate skill TTPs for compromising endpoints: SwiftBelt, Chainbreaker**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Chainbreaker</td><td><a href="https://github.com/n0fate/chainbreaker">Chainbreaker</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Chainbreaker-Tests">Chainbreaker Tests</a></td></tr><tr><td>Swiftbelt</td><td><a href="https://github.com/cedowens/SwiftBelt">SwiftBelt</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Swiftbelt-Tests">Swiftbelt Tests</a></td></tr></tbody></table>

**Section 3: Intermediate skill TTPs for compromising endpoints: Shells**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Microsoft Word Shell via Macro</td><td><a href="https://github.com/Marten4n6/EvilOSX">EvilOSX</a>, <a href="https://github.com/cedowens/EvilOSX_MacroGenerator"> MacroGenerator</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Microsoft-Word-Shell-via-Macro">Microsoft Word Shell via Macro</a></td></tr><tr><td>EvilOSX Test</td><td><a href="https://github.com/Marten4n6/EvilOSX">EvilOSX</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/EvilOSX-Test">EvilOSX Test</a></td></tr><tr><td>Microsoft Excel Netcat Listener via Macro</td><td><a href="https://en.wikipedia.org/wiki/Netcat">Netcat</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Microsoft-Excel-Netcat-Listener-via-Macro">Microsoft Excel Netcat Listener via Macro</a></td></tr><tr><td>Msfvenom Reverse TCP</td><td><a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-use-msfvenom">Msfvenom</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Msfvenom-Reverse-TCP">Msfvenom Reverse TCP</a></td></tr><tr><td>Socat</td><td><a href="https://gtfobins.github.io/gtfobins/socat/">Socat</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Socat">Socat</a></td></tr><tr><td>Netcat</td><td><a href="https://en.wikipedia.org/wiki/Netcat">Netcat</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Netcat">Netcat</a></td></tr><tr><td>PTY</td><td><a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-1-python-pty-module">PTY module</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/PTY">PTY</a></td></tr></tbody></table>

**Section 4: Process Injection**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Visual Studio Code Process Injection</td><td><a href="https://www.form3.tech/blog/engineering/electron-injection">Electron process injection</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Visual-Studio-Code-Process-Injection">Visual Studio Code Process Injection</a></td></tr><tr><td>Visual Studio Code Process Injection Persistence</td><td><a href="https://www.form3.tech/blog/engineering/electron-injection">Electron process injection</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Visual-Studio-Code-Process-Injection-Persistence">Visual Studio Code Process Injection Persistence</a></td></tr></tbody></table>

**Section 5: PUP Detections**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>TOR</td><td><a href="https://www.torproject.org/download/">TOR</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/TOR">TOR</a></td></tr><tr><td>Mouse Jiggler</td><td><a href="https://apps.apple.com/us/app/jolt-of-caffeine/id1437130425?mt=12">Jolt of Caffeine</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Jolt-of-Caffeine">Jolt of Caffeine</a></td></tr><tr><td>Keylogger</td><td><a href="https://github.com/caseyscarborough/keylogger">keylogger</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Keylogger">Keylogger</a></td></tr><tr><td>Keylogger Persistence Test</td><td><a href="https://github.com/caseyscarborough/keylogger">keylogger</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Keylogger-Persistence-Test">Keylogger Persistence Test</a></td></tr></tbody></table>

**Section 6: Attempt to disable the agent or file shipper**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Add entry to etc/hosts</td><td><a href="https://linuxize.com/post/how-to-edit-your-hosts-file/">etc/hosts entry</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Add-entry-to-etc-hosts">Add entry to etc hosts</a></td></tr><tr><td>Attempt to uninstall</td><td><a href="https://macpaw.com/how-to/uninstall-apps-on-mac-os-x#:~:text=Go%20to%20Applications%20%3E%20Utilities%20and,and%20enter%20your%20admin%20credentials.">uninstall</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Attempt-to-uninstall">Attempt to uninstall</a></td></tr><tr><td>Attempt to kill processes</td><td><a href="https://draculaservers.com/tutorials/the-pkill-command-explained/#:~:text=The%20pkill%20command%20is%20available,defined%20in%20the%20command%20parameter.">pkill</a></td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Attempt-to-kill-processes">Attempt to kill processes</a></td></tr></tbody></table>

**Section 7: Testing whether Enterprise YARA Solution can collect new file types**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>.gif</td><td>Downloaded a .gif</td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Testing-whether-Enterprise-YARA-Solution-can-collect-new-file-types">Testing whether Enterprise YARA Solution can collect new file types</a></td></tr><tr><td>.ova</td><td>Downloaded a .ova</td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Testing-whether-Enterprise-YARA-Solution-can-collect-new-file-types">Testing whether Enterprise YARA Solution can collect new file types</a></td></tr><tr><td>.rtf</td><td>Created a .rtf</td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Testing-whether-Enterprise-YARA-Solution-can-collect-new-file-types">Testing whether Enterprise YARA Solution can collect new file types</a></td></tr></tbody></table>

**Section 8: Import YARA Rules from other reputable intel sources into Enterprise YARA Solution**
<table><tbody><tr><th>Test description</th><th>Attack Type</th><th>Steps to Replicate</th></tr><tr><td>Usage of paid and open source intel</td><td>Paid: Crowdstrike / Free: Florian Roth, Reversing Labs, Elastic Security, ESET Research, Chronicle, Strangereal Intel, Blackorbird</td><td><a href="https://github.com/lawrence737/EDR-YARA-Testing/wiki/Import-YARA-Rules-from-other-reputable-intel-sources-into-Enterprise-YARA-Solution">Import YARA Rules from other reputable intel sources into Enterprise YARA Solution</a></td></tr></tbody></table>

**Detection Results Summary**
<table><tbody><tr><th>Detetion Result</th><th>EDR Solution 1</th><th>EDR Solution 2</th><th>YARA Solution</th></tr><tr><td>Detected and Blocked</td><td>10</td><td>12</td><td>N/A</td></tr><tr><td>Detected Only</td><td>0</td><td>2</td><td>11</td></tr></tbody></table>
